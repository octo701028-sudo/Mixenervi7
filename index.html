<!doctype html>
<html lang="zh-Hant">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta name="theme-color" content="#6a00ff">
<title>Enervi7 PWAï¼ˆå®Œæ•´æœ€çµ‚ç‰ˆï¼‰</title>
<link rel="manifest" href="manifest.json">
<style>
  :root { --bg:#0f0b1e; --panel:#1a1430; --accent:#6a00ff; --text:#e9e6ff; --muted:#b9b2d9; }
  *{box-sizing:border-box} body{margin:0;background:radial-gradient(1200px 600px at 80% 20%, #6a00ff10, transparent),var(--bg);color:var(--text);font-family:system-ui,-apple-system,Segoe UI,Roboto}
  header{padding:18px 16px;background:linear-gradient(90deg,#6a00ff,#8b5cf6);position:sticky;top:0}
  h1{margin:0;font-size:24px} .wrap{max-width:980px;margin:18px auto;padding:0 16px}
  .card{background:var(--panel);border:1px solid #ffffff14;border-radius:14px;padding:16px;margin:14px 0;box-shadow:0 10px 30px #00000040}
  .row{display:grid;grid-template-columns:1fr 1fr;gap:10px} @media(max-width:760px){ .row{grid-template-columns:1fr} }
  .q{margin:8px 0 14px} .q label{display:block;margin-bottom:6px;color:var(--muted)}
  input[type=range]{width:100%}
  .btn{background:var(--accent);border:none;color:white;border-radius:12px;padding:10px 14px;font-weight:600;cursor:pointer}
  canvas{width:100%;max-width:560px;height:auto;display:block;margin:auto}
  details summary{cursor:pointer;font-weight:700;margin:6px 0}
  .badge{display:inline-block;border:1px solid #ffffff24;border-radius:999px;padding:4px 10px;margin:4px 6px 0 0;color:#fff;background:#ffffff14;font-size:12px}
  .pill{border:1px solid #ffffff1f;border-radius:10px;padding:10px;margin-top:8px}
  .kv{display:flex;flex-wrap:wrap;gap:8px;margin:6px 0}
  .kv b{color:#fff}
  .hint{color:var(--muted);font-size:13px}
  .title-row{display:flex;align-items:center;gap:8px;flex-wrap:wrap}
  .chip{background:#6a00ff20;border:1px solid #6a00ff60;border-radius:999px;padding:4px 10px;font-size:12px}
</style>
</head>
<body>
<header>
  <div class="title-row">
    <h1>Enervi7 PWAï¼ˆå®Œæ•´ç‰ˆï¼‰</h1>
    <span class="chip">é›¢ç·šå¯ç”¨</span>
    <span class="chip">ä»Šæ—¥å»ºè­°ç²¾æ²¹</span>
  </div>
  <div class="hint">é‡è¡¨ï¼š0 = å®Œå…¨ä¸ç¬¦åˆ ï¼ 10 = éå¸¸ç¬¦åˆ</div>
</header>

<div class="wrap">
  <!-- é‡è¡¨ -->
  <section class="card" id="quiz">
    <h2>ğŸ§­ 14 é¡Œé‡è¡¨</h2>
    <div class="row" id="qwrap"></div>
    <button class="btn" id="gen">ç”Ÿæˆèƒ½é‡åœ– & æŒ‡å¼•</button>
  </section>

  <!-- é›·é”åœ– -->
  <section class="card">
    <h2>ğŸ“Š èƒ½é‡é›·é”åœ–</h2>
    <canvas id="radar" width="560" height="420"></canvas>
    <div class="kv" id="topkeys"></div>
  </section>

  <!-- ä»Šæ—¥å¡ç‰Œèˆ‡å»ºè­° -->
  <section class="card">
    <h2>ğŸ´ ä»Šæ—¥æŒ‡å¼•</h2>
    <div id="cards"></div>
    <div class="pill" id="dailyOil">ä»Šæ—¥å»ºè­°ç²¾æ²¹ï¼š<em>â€”</em></div>
  </section>

  <!-- ä¸ƒéšå±•é–‹ -->
  <section class="card">
    <h2>ğŸŒˆ ä¸ƒéšè³‡è¨Šå¡</h2>
    <div id="phases"></div>
  </section>
</div>

<script>
const QUESTIONS = [
 {phase:'ç™½ï½œèƒ½é‡è¦ºçŸ¥', text:'æˆ‘èƒ½æ¸…æ¥šè¦ºå¯Ÿè‡ªå·±æ­¤åˆ»çš„èº«å¿ƒç‹€æ…‹ã€‚'},
 {phase:'ç™½ï½œèƒ½é‡è¦ºçŸ¥', text:'æˆ‘èƒ½åœ¨æ··äº‚æ™‚ï¼Œè¿…é€ŸæŠŠæ³¨æ„åŠ›å¸¶å›ç•¶ä¸‹ã€‚'},
 {phase:'è—ï½œç©©å®šèˆ‡æ·¨åŒ–', text:'é¢å°å£“åŠ›æˆ–è¡çªæ™‚ï¼Œæˆ‘èƒ½ä¿æŒå†·éœä¸å¤±è¡¡ã€‚'},
 {phase:'è—ï½œç©©å®šèˆ‡æ·¨åŒ–', text:'æˆ‘èƒ½æœ‰æ•ˆåœ°é‡‹æ”¾ç´¯ç©çš„è² é¢æƒ…ç·’èˆ‡é›œå¿µã€‚'},
 {phase:'æ©™ï½œèƒ½é‡æµå‹•', text:'æˆ‘å¸¸æ„Ÿè¦ºéˆæ„Ÿï¼æƒ…æ„Ÿåœ¨é«”å…§è‡ªç„¶æµå‹•ã€‚'},
 {phase:'æ©™ï½œèƒ½é‡æµå‹•', text:'æˆ‘èƒ½é †å‹¢èª¿æ•´æ­¥èª¿ï¼Œä¸åƒµç¡¬æˆ–å¡ä½ã€‚'},
 {phase:'é»ƒï½œå…§åœ¨åŠ›é‡', text:'åšæ±ºå®šæ™‚ï¼Œæˆ‘èƒ½å …å®šåœ°é¸æ“‡å°è‡ªå·±çœŸçš„å¥½çš„äº‹ã€‚'},
 {phase:'é»ƒï½œå…§åœ¨åŠ›é‡', text:'é‡åˆ°æŒ‘æˆ°ï¼Œæˆ‘ä»èƒ½ç›¸ä¿¡è‡ªå·±ä¸¦å¾€å‰ä¸€æ­¥ã€‚'},
 {phase:'ç¶ ï½œå…±æŒ¯èˆ‡é€£çµ', text:'æˆ‘èƒ½çœŸèª è¡¨é”ï¼Œä¹Ÿæ¨‚æ–¼å‚¾è½ä»–äººã€‚'},
 {phase:'ç¶ ï½œå…±æŒ¯èˆ‡é€£çµ', text:'æˆ‘èƒ½æ„Ÿåˆ°è‡ªå·±èˆ‡ä»–äººã€èˆ‡ä¸–ç•Œæ˜¯é€£çµçš„ã€‚'},
 {phase:'é›è—ï½œæ„è­˜æ“´å±•', text:'æˆ‘ä¿¡ä»»ç›´è¦ºï¼Œä¸”èƒ½å¾ä¸­ç²å¾—æœ‰ç”¨çš„æŒ‡å¼•ã€‚'},
 {phase:'é›è—ï½œæ„è­˜æ“´å±•', text:'æˆ‘èƒ½å¾æ—¥å¸¸äº‹ä»¶çœ‹è¦‹æ›´æ·±çš„æ´è¦‹èˆ‡æ„ç¾©ã€‚'},
 {phase:'ç´«ï½œéˆé­‚æ•´åˆ', text:'æˆ‘èƒ½æŠŠéå»çš„ç¶“é©—æ•´åˆæˆåŠ›é‡ï¼Œè€Œä¸æ˜¯æ·é–ã€‚'},
 {phase:'ç´«ï½œéˆé­‚æ•´åˆ', text:'æˆ‘å¸¸æ„Ÿåˆ°è‡ªå·±å®Œæ•´ã€å°ç”Ÿå‘½æ–¹å‘è¸å¯¦å®‰å¿ƒã€‚'}
];

const PHASE_INFO = {
 'ç™½ï½œèƒ½é‡è¦ºçŸ¥': {
   key:'è¦ºçŸ¥ã€æ¸…æ˜ã€é¢å°ç•¶ä¸‹',
   actions:['å¯«ä¸‰å¥ã€Œæ­¤åˆ»æˆ‘çœŸå¯¦çš„æ„Ÿå—æ˜¯â€¦ã€','3 åˆ†é˜è…¹å¼å‘¼å¸ï¼ˆ4-4-6ï¼‰ï¼Œæ³¨æ„èº«é«”æ„Ÿå—','åˆ—å‡º 1 å€‹å¿µé ­ï¼šæ˜¯äº‹å¯¦é‚„æ˜¯è§£è®€ï¼Ÿ'],
   single:['ä¹³é¦™','å°¤åŠ åˆ©','èŒ¶æ¨¹'],
   yl:['Clarity','Awaken'],
   blocks:['å®¹æ˜“åˆ†å¿ƒã€é€ƒé¿æ„Ÿå—','è³‡è¨Šéè¼‰ï¼Œé›£ä»¥å›åˆ°ä¸­å¿ƒ']
 },
 'è—ï½œç©©å®šèˆ‡æ·¨åŒ–': {
   key:'ç©©å®šã€é‡‹æ”¾ã€ç•Œç·š',
   actions:['å¯«ä¸‹æœ€å›°æ“¾ä½ çš„ 1 ä»¶äº‹ï¼Œæ¨™è¨»å¯æ§ / ä¸å¯æ§','èµ° 10 åˆ†é˜è®“èº«é«”ä»£è¬å£“åŠ›','ç¡å‰å¯« 3 ä»¶ä»Šå¤©å¯æ„Ÿè¬ä¹‹äº‹'],
   single:['é¼ å°¾è‰','è–„è·','æª¸æª¬'],
   yl:['Stress Away','Peace & Calming','Grounding'],
   blocks:['è¢«å£“åŠ›åæ²’','æƒ…ç·’å›¤ç©ï¼Œé›£ä»¥æ’è§£']
 },
 'æ©™ï½œèƒ½é‡æµå‹•': {
   key:'æµå‹•ã€å‰µé€ ã€æ„Ÿå—',
   actions:['5 åˆ†é˜è‡ªç”±æ›¸å¯«ï¼Œåªå¯«æ„Ÿå—æˆ–æƒ³åšçš„äº‹','å®‰æ’ 1 ä»¶å°ç©æ¨‚','æŠŠä»Šå¤© Toâ€‘do åˆ‡æˆ 10 åˆ†é˜ä¸€å°æ­¥'],
   single:['ç”œæ©™','ä¾è˜­','ä½›æ‰‹æŸ‘'],
   yl:['Joy','Abundance','Aroma Siez'],
   blocks:['æƒ…ç·’å¡ä½ã€ç¼ºä¹å½ˆæ€§','æ‹–å»¶ï¼Œç¼ºå°‘ç«èŠ±']
 },
 'é»ƒï½œå…§åœ¨åŠ›é‡': {
   key:'è‡ªä¿¡ã€é‚Šç•Œã€è¡Œå‹•',
   actions:['è¨­å®š 1 ä»¶ MIT ä¸¦ç«‹åˆ»è¡Œå‹• 10 åˆ†é˜','ç·´ç¿’èªªä¸€å€‹æ¸…æ¥šçš„ã€Œä¸ã€','å®Œæˆå¾Œå‘ä¿¡ä»»å°è±¡å…¬é–‹å›å ±'],
   single:['æª¸æª¬è‰','è¿·è¿­é¦™','è–‘'],
   yl:['Valor','Believe','Enâ€‘Râ€‘Gâ€‘E'],
   blocks:['éåº¦ä¾è³´ä»–äººæ„è¦‹','å®³æ€•å¤±æ•—è€Œä¸å‰é€²']
 },
 'ç¶ ï½œå…±æŒ¯èˆ‡é€£çµ': {
   key:'çœŸèª ã€å…±é³´ã€é—œä¿‚',
   actions:['å‚¾è½ 1 äºº 3 åˆ†é˜ï¼Œåªå›é¥‹æ„Ÿå—','å‚³ä¸€å‰‡è¬è¬è¨Šæ¯','å°è‡ªå·±åšä¸€ä»¶æº«æŸ”çš„äº‹'],
   single:['ç«ç‘°è‰','å¤©ç«ºè‘µ','ç«ç‘°'],
   yl:['Harmony','Acceptance','Christmas Spirit'],
   blocks:['å®³æ€•è¢«æ‹’çµ•ã€é›£æ•é–‹','ä»˜å‡ºèˆ‡æ¥æ”¶ä¸å¹³è¡¡']
 },
 'é›è—ï½œæ„è­˜æ“´å±•': {
   key:'ç›´è¦ºã€æ´è¦‹ã€å†¥æƒ³',
   actions:['3 åˆ†é˜éœå¿ƒï¼šå¸ 4 / åœ 4 / å‘¼ 6','å¯«ä¸‹ä¸€å¥ä»Šå¤©çš„ç›´è¦ºè¨Šæ¯','å›é¡§ä»Šå¤©æœ€æœ‰å•Ÿç™¼çš„ä¸€åˆ»'],
   single:['è–°è¡£è‰','ä¹³é¦™','æª€é¦™'],
   yl:['Dream Catcher','Forgiveness','Highest Potential'],
   blocks:['ä¸ä¿¡ä»»è‡ªå·±çš„ç›´è¦º','éåº¦ç†æ€§ï¼Œå¿½ç•¥å…§åœ¨è²éŸ³']
 },
 'ç´«ï½œéˆé­‚æ•´åˆ': {
   key:'æ•´åˆã€å…¨è²Œã€è‡£æœ',
   actions:['æŠŠä¸€æ®µéå»ç¶“é©—å¯«æˆã€ŒåŠ›é‡æ•…äº‹ã€','å¯«ä¸‹ä¸€ä»¶æ§åˆ¶ä¸ä¾†çš„äº‹ä¸¦è¨»è¨˜ã€Œæˆ‘é¸æ“‡å…è¨±ã€','ä»Šæ™šæ—©ç¡ 30 åˆ†é˜'],
   single:['å»£è—¿é¦™','å²©è˜­è‰','é›ªæ¾'],
   yl:['White Angelica','Sacred Mountain','Transformation'],
   blocks:['é™·å…¥æ··äº‚ï¼Œçœ‹ä¸è¦‹æ–¹å‘','æ„Ÿåˆ°ç ´ç¢ï¼Œç¼ºä¹æ•´åˆæ„Ÿ']
 }
};

const qwrap = document.getElementById('qwrap');
QUESTIONS.forEach((q, i)=>{
  const div = document.createElement('div');
  div.className = 'q card';
  div.innerHTML = `
    <label>${i+1}. <b>${q.phase}</b>ï½œ${q.text}</label>
    <input type="range" min="0" max="10" step="1" value="5" id="q${i}">
    <div class="hint">0 = å®Œå…¨ä¸ç¬¦åˆã€€/ã€€10 = éå¸¸ç¬¦åˆ</div>
  `;
  qwrap.appendChild(div);
});

function computeScores(){
  const phases = Object.keys(PHASE_INFO);
  const vals = {}; let idx = 0;
  phases.forEach(p=>{
    const a = parseInt(document.getElementById(`q${idx++}`).value,10);
    const b = parseInt(document.getElementById(`q${idx++}`).value,10);
    vals[p] = (a + b) / 2;
  });
  return vals;
}

function drawRadar(scores){
  const canvas = document.getElementById('radar');
  const ctx = canvas.getContext('2d');
  const W = canvas.width, H = canvas.height;
  ctx.clearRect(0,0,W,H);
  const cx = W/2, cy = H/2 + 10, R = Math.min(W,H)/2 - 40;
  const phases = Object.keys(scores);
  const N = phases.length;
  ctx.strokeStyle = '#ffffff22';
  for(let r=R; r>R/5; r-=R/5){ ctx.beginPath(); ctx.arc(cx, cy, r, 0, Math.PI*2); ctx.stroke(); }
  for(let i=0;i<N;i++){
    const ang = -Math.PI/2 + i*(Math.PI*2/N);
    ctx.beginPath(); ctx.moveTo(cx,cy);
    ctx.lineTo(cx + Math.cos(ang)*R, cy + Math.sin(ang)*R); ctx.stroke();
    const tx = cx + Math.cos(ang)*(R+14), ty = cy + Math.sin(ang)*(R+14);
    ctx.fillStyle = '#b9b2d9'; ctx.font = '12px system-ui';
    ctx.textAlign = Math.cos(ang)>0? 'left' : 'right';
    ctx.fillText(phases[i].split('ï½œ')[0], tx, ty);
  }
  ctx.beginPath();
  for(let i=0;i<N;i++){
    const val = scores[phases[i]]/10;
    const ang = -Math.PI/2 + i*(Math.PI*2/N);
    const x = cx + Math.cos(ang)*R*val, y = cy + Math.sin(ang)*R*val;
    if(i===0) ctx.moveTo(x,y); else ctx.lineTo(x,y);
  }
  ctx.closePath(); ctx.fillStyle = '#6a00ff55'; ctx.strokeStyle = '#6a00ff'; ctx.lineWidth = 2; ctx.fill(); ctx.stroke();
}

function renderResult(scores){
  drawRadar(scores);
  const entries = Object.entries(scores).sort((a,b)=>b[1]-a[1]);
  const top = entries[0][0], low = entries[entries.length-1][0];
  const topdiv = document.getElementById('topkeys');
  topdiv.innerHTML = `<span class="badge">æœ€é«˜ï¼š${top} ${scores[top].toFixed(1)}</span>
                      <span class="badge">æœ€ä½ï¼š${low} ${scores[low].toFixed(1)}</span>`;
  const c = document.getElementById('cards'); c.innerHTML='';
  function card(title, body){ const el=document.createElement('div'); el.className='pill'; el.innerHTML=`<b>${title}</b><div class="hint" style="margin-top:6px">${body}</div>`; c.appendChild(el); }
  card('å„ªå‹¢ä¹‹å…‰', `${top} â€” ${PHASE_INFO[top].key}`);
  card('è£œçµ¦ä¹‹å…‰', `${low} â€” ${PHASE_INFO[low].key}`);
  card('ä»Šæ—¥è¡Œå‹•', PHASE_INFO[top].actions[0]);
  const INS = ["æˆç‚ºï¼Œæ˜¯å…è¨±ä½ å‡ºç¾ã€‚","è‡ªç”±ï¼Œä¸æ˜¯é€ƒé›¢ï¼Œè€Œæ˜¯ä¸å†å£“æŠ‘çœŸå¯¦çš„è‡ªå·±ã€‚","ä½ ä¸æ˜¯åœ¨å°‹æ‰¾ï¼Œè€Œæ˜¯åœ¨è¨˜å¾—ã€‚","éœé»˜ï¼Œä¸æ˜¯ç©ºç™½ï¼Œæ˜¯èªè¨€ä¹‹å‰çš„å®Œæ•´ã€‚"];
  card('éˆå…‰å•Ÿç¤º', INS[Math.floor(Math.random()*INS.length)]);
}

document.getElementById('gen').addEventListener('click', async ()=>{
  const scores = computeScores();
  renderResult(scores);
  try{
    const res = await fetch('yl_blends.json'); const list = await res.json();
    const pick = list[Math.floor(Math.random()*list.length)];
    document.querySelector('#dailyOil').innerHTML = `ä»Šæ—¥å»ºè­°ç²¾æ²¹ï¼š<b>${pick.name}</b> <span class="hint">${pick.desc||''}</span>`;
  }catch(e){ document.querySelector('#dailyOil').innerHTML = 'ä»Šæ—¥å»ºè­°ç²¾æ²¹ï¼šè¼‰å…¥å¤±æ•—'; }
});

const ph = document.getElementById('phases');
Object.entries(PHASE_INFO).forEach(([name,info])=>{
  const d = document.createElement('details');
  d.innerHTML = `<summary>${name}</summary>
    <div class="kv"><span class="badge">é—œéµå­—</span><span>${info.key}</span></div>
    <div class="kv"><span class="badge">è¡Œå‹•å»ºè­°</span><ul>${info.actions.map(a=>`<li>${a}</li>`).join('')}</ul></div>
    <div class="kv"><span class="badge">å–®æ–¹ç²¾æ²¹</span><b>${info.single.join('ã€')}</b></div>
    <div class="kv"><span class="badge">æ¨è–¦è¤‡æ–¹</span><b>${info.yl.join('ã€')}</b></div>
    <div class="kv"><span class="badge">å¸¸è¦‹å¡é»</span><ul>${info.blocks.map(b=>`<li>${b}</li>`).join('')}</ul></div>`;
  d.className='pill'; ph.appendChild(d);
});

if('serviceWorker' in navigator){ navigator.serviceWorker.register('sw.js'); }
</script>
</body>
</html>
